services:
  aletheia:
    build:
      context: ../..
      dockerfile: deploy/docker/Dockerfile
    container_name: aletheia
    ports:
      - "8000:8000"
    volumes:
      - aletheia-data:/data
    environment:
      - ALETHEIA_DATA_REPO=${ALETHEIA_DATA_REPO:-}
    secrets:
      - deploy_key
    restart: unless-stopped

secrets:
  deploy_key:
    file: ${DEPLOY_KEY_PATH:-~/.ssh/aletheia_deploy}

volumes:
  aletheia-data:
